\SetAlgoNlRelativeSize{-2}

\newcommand{\myfunction}[2]{\textbf{#1}\textbf{ (}#2\textbf{ )}} % \myfunction{name}{params}
\newcommand{\myvar}[2]{$\text{#1}_{\text{#2}}$} 
\newcommand{\nid}[1]{\myvar{n\_id}{#1}}
\newcommand{\continue}{\textbf{continue}}
\newcommand{\annot}[1]{$\triangleright$ {\footnotesize \texttt{ #1 }}}

\begin{algorithm}

    \caption{TGMK - Framework}\label{tgmk}

    \KwIn{TemporalGraph, NodeFeatures}
    \KwOut{Encoder, Decoder}
    
    MM      \annot{Mechanism to retain previous information} \\
    Encoder \annot{GNN for encoding graphs into embeddings} \\
    Decoder \annot{Link Prediction for downstream tasks} \\
    Loader  \annot{Data Loader for Temporal Graphs, including negative sampling} \\
    
    \For{i, batch $\in$ Loader}{
        
        \annot{unpack the information from batch} \\
        \nid{src}, \nid{pos\_dst}, \nid{neg\_dst}, \myvar{edge\_attr}{}, \myvar{t}{} = \myvar{batch}{} \\
        \If{i==0}{
            \myfunction{MM.store}{\nid{src}, \nid{pos\_dst}, \myvar{edge\_attr}{}, \myvar{t}{}} \\
            \continue
        } 
        \annot{retrieve memory information} \\
        \nid{} = \nid{src} + \nid{pos\_dst} + \nid{neg\_dst} \\
        
        \myvar{memory}{} = \myfunction{MM.retrieve}{\nid{}} \\

        \annot{encode the graph into embeddings} \\
        \myvar{z}{} = \myfunction{Encoder}{} \\

        \annot{decode the embeddings into link prediction} \\
        $\hat{y}$ = \myfunction{Decoder}{} \\

        \annot{update current information to memory} \\
        \myfunction{MM.store}{\nid{src}, \nid{pos\_dst}, \myvar{edge\_attr}{}, \myvar{t}{}} \\
        
    }


\end{algorithm}